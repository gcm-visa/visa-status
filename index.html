<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Visa Application Tracking</title>
  <script>
    function searchPassport() {
      var searchInput = document.getElementById("passportInput").value.trim();
      var resultDiv = document.getElementById("result");
      var loader = document.getElementById("loadingSpinner");

      if (!searchInput) {
        resultDiv.innerHTML = "<p style='color:red;'>Please enter a valid ID or Passport Number.</p>";
        return;
      }

      resultDiv.innerHTML = "";
      loader.style.display = "block";

      fetch("https://script.google.com/macros/s/AKfycbxjFlKSj05lGAg11cd7ets3m5HhfY6Mw1hRSarOA6AzFz4C-FK0ei_q3TDKJChigb6v/exec", {
        method: "POST",
        body: new URLSearchParams({
          'searchInput': searchInput
        })
      })
      .then(response => response.json())
      .then(result => {
        loader.style.display = "none";
        displayResult(result);
      })
      .catch(error => {
        loader.style.display = "none";
        resultDiv.innerHTML = "<p style='color:red;'>An error occurred. Please try again later.</p>";
      });
    }

    function displayResult(result) {
      var resultDiv = document.getElementById("result");
      if (!result) {
        resultDiv.innerHTML = "<p style='color:red;'>No matching record found.</p>";
        return;
      }

      // Display result (you can format it as needed)
      resultDiv.innerHTML = JSON.stringify(result);  // Just an example of displaying it
    }
  </script>
</head>
<body>
  <input type="text" id="passportInput" placeholder="Enter ID or Passport Number">
  <button onclick="searchPassport()">Search</button>
  <div id="loadingSpinner" style="display:none;">Loading...</div>
  <div id="result"></div>
</body>
</html>
